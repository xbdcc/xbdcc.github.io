
 <!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  
    <title>Xposed系列之微信屏蔽拍一拍(三) | Carlos</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="Carlos">
    

    
    <meta name="description" content="简书链接：https:&#x2F;&#x2F;www.jianshu.com&#x2F;p&#x2F;616be7deec33   Xposed系列之前文章如下：  Xposed系列之Demo上手指南及源码解析(一) Xposed系列之微信装X指南(二)  需求需求来自于看到的热搜，微信拍一拍好多人说不支持关闭，容易误触。所以想着Hook下可以屏蔽自己的拍一拍  &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;     结果最后代码实现">
<meta property="og:type" content="article">
<meta property="og:title" content="Xposed系列之微信屏蔽拍一拍(三)">
<meta property="og:url" content="http://yoursite.com/2020/07/15/Xposed%E7%B3%BB%E5%88%97%E4%B9%8B%E5%BE%AE%E4%BF%A1%E5%B1%8F%E8%94%BD%E6%8B%8D%E4%B8%80%E6%8B%8D(%E4%B8%89)/index.html">
<meta property="og:site_name" content="Carlos">
<meta property="og:description" content="简书链接：https:&#x2F;&#x2F;www.jianshu.com&#x2F;p&#x2F;616be7deec33   Xposed系列之前文章如下：  Xposed系列之Demo上手指南及源码解析(一) Xposed系列之微信装X指南(二)  需求需求来自于看到的热搜，微信拍一拍好多人说不支持关闭，容易误触。所以想着Hook下可以屏蔽自己的拍一拍  &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;     结果最后代码实现">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://xbdcc.cn/image/CXposed/wechat/beat_background1.jpg">
<meta property="og:image" content="http://xbdcc.cn/image/CXposed/wechat/beat_background2.jpg">
<meta property="og:image" content="http://xbdcc.cn/image/CXposed/wechat/beat.gif">
<meta property="og:image" content="http://xbdcc.cn/image/CXposed/wechat/beat_ui.jpg">
<meta property="article:published_time" content="2020-07-15T15:28:00.000Z">
<meta property="article:modified_time" content="2020-07-25T15:38:21.000Z">
<meta property="article:author" content="Carlos">
<meta property="article:tag" content="Android">
<meta property="article:tag" content="Xposed">
<meta property="article:tag" content="逆向">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://xbdcc.cn/image/CXposed/wechat/beat_background1.jpg">

    
    <link rel="alternative" href="/atom.xml" title="Carlos" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/xiaobudian.jpg">
    
    
    <link rel="apple-touch-icon" href="/img/jacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg">
    
    
<link rel="stylesheet" href="/css/style.css">



    <meta name="baidu-site-verification" content="ZXZX44IZdr" />


</head>

  <body>
    <header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/xiaobudian.jpg" alt="Carlos" title="Carlos"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="Carlos">Carlos</a></h1>
				<h2 class="blog-motto">没有什么到不了的地方，没有什么上不了的天堂，相信就有力量。不骄不躁，不卑不亢，不屈不挠。</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">主页</a></li>
					
						<li><a href="/archives">归档</a></li>
					
						<li><a href="/me">关于</a></li>
					
					<li>
 					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" name="q" autocomplete="off" maxlength="20" placeholder="搜索" />
						<input type="hidden" name="q" value="site:yoursite.com">
					</form>
						
					</li>
					
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
  
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2020/07/15/Xposed系列之微信屏蔽拍一拍(三)/" title="Xposed系列之微信屏蔽拍一拍(三)" itemprop="url">Xposed系列之微信屏蔽拍一拍(三)</a>
  </h1>
  <p class="article-author">By
       
		<a href="/me" title="Carlos" target="_blank" itemprop="author">Carlos</a>
		
  <p class="article-time">
    <time datetime="2020-07-15T15:28:00.000Z" itemprop="datePublished"> 发表于 2020-07-15</time>
    
  </p>
</header>
	<div class="article-content">
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">文章目录</strong>
		
			<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9C%80%E6%B1%82"><span class="toc-number">1.</span> <span class="toc-text">需求</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%93%E6%9E%9C"><span class="toc-number">2.</span> <span class="toc-text">结果</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%86%E6%9E%90UI"><span class="toc-number">3.</span> <span class="toc-text">分析UI</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%86%E6%9E%90%E4%BB%A3%E7%A0%81"><span class="toc-number">4.</span> <span class="toc-text">分析代码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BC%96%E5%86%99%E4%BB%A3%E7%A0%81"><span class="toc-number">5.</span> <span class="toc-text">编写代码</span></a></li></ol>
		
		</div>
		
		<p>简书链接：<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/616be7deec33">https://www.jianshu.com/p/616be7deec33</a>  </p>
<p>Xposed系列之前文章如下：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/xbdcc/CXposed/blob/master/demo/README.md">Xposed系列之Demo上手指南及源码解析(一)</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/xbdcc/CXposed/blob/master/README.md">Xposed系列之微信装X指南(二)</a></li>
</ul>
<h2 id="需求"><a href="#需求" class="headerlink" title="需求"></a>需求</h2><p>需求来自于看到的热搜，微信拍一拍好多人说不支持关闭，容易误触。所以想着Hook下可以屏蔽自己的拍一拍</p>
<figure>
<img src="http://xbdcc.cn/image/CXposed/wechat/beat_background1.jpg" height="600"/>&nbsp;&nbsp;&nbsp;&nbsp;
<img src="http://xbdcc.cn/image/CXposed/wechat/beat_background2.jpg" height="600"/>
</figure>


<h2 id="结果"><a href="#结果" class="headerlink" title="结果"></a>结果</h2><p>最后代码实现的效果如下，屏蔽了双击”拍一拍”：</p>
<p><img src="http://xbdcc.cn/image/CXposed/wechat/beat.gif"></p>
<h2 id="分析UI"><a href="#分析UI" class="headerlink" title="分析UI"></a>分析UI</h2><p>可以拦截的地方有很多处，这里就从最直观容易分析Hook的地方入手，分析方法上篇讲了很多了，这里就不再详细介绍了。<br>找到拍一拍双击点，可以看到id为<code>aku</code>的控件就是显示的头像，而它的点击和长按属性都为true，这个应该也是双击的控件<br><img src="http://xbdcc.cn/image/CXposed/wechat/beat_ui.jpg"></p>
<p>然后通过通过<code>adb shell dumpsys activity top &gt; activity_top.txt</code>，找到id为<code>aku</code>的那一行信息如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">com.tencent.mm.ui.chatting.view.AvatarImageView&#123;8c74400 V.ED..CL. ........ 0,0-122,122 #7f090708 app:id/aku&#125;</span><br></pre></td></tr></table></figure>
<p>可以看到该ImageView为自定义控件<code>AvatarImageView</code>，所以我们就可以去到这个自定义控件里面去看它的代码了</p>
<h2 id="分析代码"><a href="#分析代码" class="headerlink" title="分析代码"></a>分析代码</h2><p>反编译APK查看<code>AvatarImageView</code>类的完整代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AvatarImageView</span> <span class="keyword">extends</span> <span class="title class_">AppCompatImageView</span> <span class="keyword">implements</span> <span class="title class_">m</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> Ihh;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String TAG;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> pageType;</span><br><span class="line">    <span class="keyword">private</span> i yXY;</span><br><span class="line">    <span class="keyword">private</span> String zkN;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">AvatarImageView</span><span class="params">(Context context, AttributeSet attributeSet)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>(context, attributeSet, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">AvatarImageView</span><span class="params">(Context context, AttributeSet attributeSet, <span class="type">int</span> i)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(context, attributeSet, i);</span><br><span class="line">        AppMethodBeat.i(<span class="number">36689</span>);</span><br><span class="line">        <span class="built_in">this</span>.TAG = <span class="string">&quot;MicroMsg.AvatarImageView&quot;</span>;</span><br><span class="line">        <span class="built_in">this</span>.pageType = -<span class="number">1</span>;</span><br><span class="line">        <span class="built_in">this</span>.yXY = <span class="literal">null</span>;</span><br><span class="line">        <span class="built_in">this</span>.zkN = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="built_in">this</span>.Ihh = <span class="literal">true</span>;</span><br><span class="line">        <span class="built_in">this</span>.yXY = ((e) g.ad(e.class)).getStoryUIFactory().gq(context);</span><br><span class="line">        <span class="built_in">this</span>.yXY.aZ(<span class="built_in">this</span>);</span><br><span class="line">        setLayerType(<span class="number">1</span>, (Paint) <span class="literal">null</span>);</span><br><span class="line">        AppMethodBeat.o(<span class="number">36689</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* access modifiers changed from: protected */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onDraw</span><span class="params">(Canvas canvas)</span> &#123;</span><br><span class="line">        AppMethodBeat.i(<span class="number">36690</span>);</span><br><span class="line">        <span class="built_in">super</span>.onDraw(canvas);</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">this</span>.Ihh) &#123;</span><br><span class="line">            <span class="built_in">this</span>.yXY.a(canvas, <span class="literal">true</span>, <span class="number">0</span>);</span><br><span class="line">            AppMethodBeat.o(<span class="number">36690</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">this</span>.yXY.a(canvas, <span class="literal">false</span>, <span class="number">0</span>);</span><br><span class="line">        AppMethodBeat.o(<span class="number">36690</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* access modifiers changed from: protected */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onMeasure</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> i2)</span> &#123;</span><br><span class="line">        AppMethodBeat.i(<span class="number">36691</span>);</span><br><span class="line">        <span class="built_in">super</span>.onMeasure(i, i2);</span><br><span class="line">        AppMethodBeat.o(<span class="number">36691</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setOnClickListener</span><span class="params">(View.OnClickListener onClickListener)</span> &#123;</span><br><span class="line">        AppMethodBeat.i(<span class="number">36692</span>);</span><br><span class="line">        <span class="built_in">super</span>.setOnClickListener(<span class="built_in">this</span>.yXY.dUH());</span><br><span class="line">        <span class="built_in">this</span>.yXY.setOnClickListener(onClickListener);</span><br><span class="line">        AppMethodBeat.o(<span class="number">36692</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setOnDoubleClickListener</span><span class="params">(i.a aVar)</span> &#123;</span><br><span class="line">        AppMethodBeat.i(<span class="number">36693</span>);</span><br><span class="line">        <span class="built_in">this</span>.yXY.setOnDoubleClickListener(aVar);</span><br><span class="line">        AppMethodBeat.o(<span class="number">36693</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setShowStoryHint</span><span class="params">(<span class="type">boolean</span> z)</span> &#123;</span><br><span class="line">        AppMethodBeat.i(<span class="number">36694</span>);</span><br><span class="line">        <span class="built_in">this</span>.yXY.setShowStoryHint(z);</span><br><span class="line">        AppMethodBeat.o(<span class="number">36694</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title function_">eM</span><span class="params">(String str, <span class="type">int</span> i)</span> &#123;</span><br><span class="line">        AppMethodBeat.i(<span class="number">36695</span>);</span><br><span class="line">        <span class="built_in">this</span>.yXY.eM(str, i);</span><br><span class="line">        <span class="built_in">this</span>.zkN = str;</span><br><span class="line">        AppMethodBeat.o(<span class="number">36695</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setChattingBG</span><span class="params">(<span class="type">boolean</span> z)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.Ihh = z;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title function_">bO</span><span class="params">(String str, <span class="type">boolean</span> z)</span> &#123;</span><br><span class="line">        AppMethodBeat.i(<span class="number">36696</span>);</span><br><span class="line">        <span class="keyword">if</span> (TextUtils.isEmpty(str) || getContext() == <span class="literal">null</span>) &#123;</span><br><span class="line">            AppMethodBeat.o(<span class="number">36696</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (str.equals(<span class="built_in">this</span>.zkN)) &#123;</span><br><span class="line">            setShowStoryHint(!z);</span><br><span class="line">        &#125;</span><br><span class="line">        AppMethodBeat.o(<span class="number">36696</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* access modifiers changed from: protected */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onDetachedFromWindow</span><span class="params">()</span> &#123;</span><br><span class="line">        AppMethodBeat.i(<span class="number">36697</span>);</span><br><span class="line">        <span class="built_in">super</span>.onDetachedFromWindow();</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">this</span>.pageType != -<span class="number">1</span>) &#123;</span><br><span class="line">            a.b(<span class="built_in">this</span>.pageType, <span class="built_in">this</span>.zkN, <span class="built_in">this</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        AppMethodBeat.o(<span class="number">36697</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以看到其中有个<code>setOnDoubleClickListener</code>方法，很明显这个就是我们双击事件的监听，所以我们可以Hook这个方法做拦截，<br>让他后面拍一拍的操作都不执行就可以了，当然你还可以继续往里面分析拍一拍执行网络请求或数据库操作显示UI等的地方做拦截。<br>我们看到<code>setOnDoubleClickListener</code>方法里面传了参数<code>i.a aVar</code>，需要先知道下这个参数是什么，继续看<code>i</code>的代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">i</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">a</span> &#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="title function_">fl</span><span class="params">(View view)</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">a</span><span class="params">(Canvas canvas, <span class="type">boolean</span> z, <span class="type">int</span> i)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">aZ</span><span class="params">(View view)</span>;</span><br><span class="line"></span><br><span class="line">    View.OnClickListener <span class="title function_">dUH</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">eM</span><span class="params">(String str, <span class="type">int</span> i)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">setOnClickListener</span><span class="params">(View.OnClickListener onClickListener)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">setOnDoubleClickListener</span><span class="params">(a aVar)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">setShowStoryHint</span><span class="params">(<span class="type">boolean</span> z)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">setWeakContext</span><span class="params">(Context context)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>查看代码得知<code>i</code>为一个接口，并且内部有一个接口<code>a</code>，因为是内部类，所以要加<code>$</code>，找到后就可以开始写Hook代码了</p>
<h2 id="编写代码"><a href="#编写代码" class="headerlink" title="编写代码"></a>编写代码</h2><p>最终实现代码如下：</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">hookBeat</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">val</span> hookClass = classLoader.loadClass(<span class="string">&quot;com.tencent.mm.plugin.story.api.i\$a&quot;</span>)</span><br><span class="line">    XposedHelpers.findAndHookMethod(<span class="string">&quot;com.tencent.mm.ui.chatting.view.AvatarImageView&quot;</span>,</span><br><span class="line">        classLoader,</span><br><span class="line">        <span class="string">&quot;setOnDoubleClickListener&quot;</span>,</span><br><span class="line">        hookClass,</span><br><span class="line">        <span class="keyword">object</span> : XC_MethodReplacement() &#123;</span><br><span class="line">            <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">replaceHookedMethod</span><span class="params">(param: <span class="type">MethodHookParam</span>?)</span></span>: Any &#123;</span><br><span class="line">                xlog(<span class="string">&quot;replace double click&quot;</span>)</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>到这里其实已经结束了，但是代码还可以做下优化，我们查看<code>findAndHookMethod</code>方法源码及注释，可以看到注释里有例子<code>parameterTypesAndCallback</code>参数也可以直接传如<code>&quot;com.example.MyClass&quot;</code>，<br>所以内部提供了这种方法我们就不用外部去loadClass，直接把类名传进来就是了。仔细看源码注释也会发现这个例子有个小bug，Hook的时候少传了方法名<code>doSomething</code>。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Look up a method and hook it. The last argument must be the callback for the hook.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;This combines calls to &#123;<span class="doctag">@link</span> #findMethodExact(Class, String, Object...)&#125; and</span></span><br><span class="line"><span class="comment"> * &#123;<span class="doctag">@link</span> XposedBridge#hookMethod&#125;.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * &lt;p class=&quot;warning&quot;&gt;The method must be declared or overridden in the given class, inherited</span></span><br><span class="line"><span class="comment"> * methods are not considered! That&#x27;s because each method implementation exists only once in</span></span><br><span class="line"><span class="comment"> * the memory, and when classes inherit it, they just get another reference to the implementation.</span></span><br><span class="line"><span class="comment"> * Hooking a method therefore applies to all classes inheriting the same implementation. You</span></span><br><span class="line"><span class="comment"> * have to expect that the hook applies to subclasses (unless they override the method), but you</span></span><br><span class="line"><span class="comment"> * shouldn&#x27;t have to worry about hooks applying to superclasses, hence this &quot;limitation&quot;.</span></span><br><span class="line"><span class="comment"> * There could be undesired or even dangerous hooks otherwise, e.g. if you hook</span></span><br><span class="line"><span class="comment"> * &#123;<span class="doctag">@code</span> SomeClass.equals()&#125; and that class doesn&#x27;t override the &#123;<span class="doctag">@code</span> equals()&#125; on some ROMs,</span></span><br><span class="line"><span class="comment"> * making you hook &#123;<span class="doctag">@code</span> Object.equals()&#125; instead.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;There are two ways to specify the parameter types. If you already have a reference to the</span></span><br><span class="line"><span class="comment"> * &#123;<span class="doctag">@link</span> Class&#125;, use that. For Android framework classes, you can often use something like</span></span><br><span class="line"><span class="comment"> * &#123;<span class="doctag">@code</span> String.class&#125;. If you don&#x27;t have the class reference, you can simply use the</span></span><br><span class="line"><span class="comment"> * full class name as a string, e.g. &#123;<span class="doctag">@code</span> java.lang.String&#125; or &#123;<span class="doctag">@code</span> com.example.MyClass&#125;.</span></span><br><span class="line"><span class="comment"> * It will be passed to &#123;<span class="doctag">@link</span> #findClass&#125; with the same class loader that is used for the target</span></span><br><span class="line"><span class="comment"> * method, see its documentation for the allowed notations.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;Primitive types, such as &#123;<span class="doctag">@code</span> int&#125;, can be specified using &#123;<span class="doctag">@code</span> int.class&#125; (recommended)</span></span><br><span class="line"><span class="comment"> * or &#123;<span class="doctag">@code</span> Integer.TYPE&#125;. Note that &#123;<span class="doctag">@code</span> Integer.class&#125; doesn&#x27;t refer to &#123;<span class="doctag">@code</span> int&#125; but to</span></span><br><span class="line"><span class="comment"> * &#123;<span class="doctag">@code</span> Integer&#125;, which is a normal class (boxed primitive). Therefore it must not be used when</span></span><br><span class="line"><span class="comment"> * the method expects an &#123;<span class="doctag">@code</span> int&#125; parameter - it has to be used for &#123;<span class="doctag">@code</span> Integer&#125; parameters</span></span><br><span class="line"><span class="comment"> * though, so check the method signature in detail.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;As last argument to this method (after the list of target method parameters), you need</span></span><br><span class="line"><span class="comment"> * to specify the callback that should be executed when the method is invoked. It&#x27;s usually</span></span><br><span class="line"><span class="comment"> * an anonymous subclass of &#123;<span class="doctag">@link</span> XC_MethodHook&#125; or &#123;<span class="doctag">@link</span> XC_MethodReplacement&#125;.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;&lt;b&gt;Example&lt;/b&gt;</span></span><br><span class="line"><span class="comment"> * &lt;pre class=&quot;prettyprint&quot;&gt;</span></span><br><span class="line"><span class="comment"> * // In order to hook this method ...</span></span><br><span class="line"><span class="comment"> * package com.example;</span></span><br><span class="line"><span class="comment"> * public class SomeClass &#123;</span></span><br><span class="line"><span class="comment"> *   public int doSomething(String s, int i, MyClass m) &#123;</span></span><br><span class="line"><span class="comment"> *     ...</span></span><br><span class="line"><span class="comment"> *   &#125;</span></span><br><span class="line"><span class="comment"> * &#125;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * // ... you can use this call:</span></span><br><span class="line"><span class="comment"> * findAndHookMethod(&quot;com.example.SomeClass&quot;, lpparam.classLoader, String.class, int.class, &quot;com.example.MyClass&quot;, new XC_MethodHook() &#123;</span></span><br><span class="line"><span class="comment"> *   &amp;#64;Override</span></span><br><span class="line"><span class="comment"> *   protected void beforeHookedMethod(MethodHookParam param) throws Throwable &#123;</span></span><br><span class="line"><span class="comment"> *     String oldText = (String) param.args[0];</span></span><br><span class="line"><span class="comment"> *     Log.d(&quot;MyModule&quot;, oldText);</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *     param.args[0] = &quot;test&quot;;</span></span><br><span class="line"><span class="comment"> *     param.args[1] = 42; // auto-boxing is working here</span></span><br><span class="line"><span class="comment"> *     setBooleanField(param.args[2], &quot;great&quot;, true);</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *     // This would not work (as MyClass can&#x27;t be resolved at compile time):</span></span><br><span class="line"><span class="comment"> *     //   MyClass myClass = (MyClass) param.args[2];</span></span><br><span class="line"><span class="comment"> *     //   myClass.great = true;</span></span><br><span class="line"><span class="comment"> *   &#125;</span></span><br><span class="line"><span class="comment"> * &#125;);</span></span><br><span class="line"><span class="comment"> * &lt;/pre&gt;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> className The name of the class which implements the method.</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> classLoader The class loader for resolving the target and parameter classes.</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> methodName The target method name.</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> parameterTypesAndCallback The parameter types of the target method, plus the callback.</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@throws</span> NoSuchMethodError In case the method was not found.</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@throws</span> ClassNotFoundError In case the target class or one of the parameter types couldn&#x27;t be resolved.</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> An object which can be used to remove the callback again.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> XC_MethodHook.Unhook <span class="title function_">findAndHookMethod</span><span class="params">(String className, ClassLoader classLoader, String methodName, Object... parameterTypesAndCallback)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> findAndHookMethod(findClass(className, classLoader), methodName, parameterTypesAndCallback);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>优化后代码如下：</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">hookBeat</span><span class="params">()</span></span> &#123;</span><br><span class="line">    XposedHelpers.findAndHookMethod(<span class="string">&quot;com.tencent.mm.ui.chatting.view.AvatarImageView&quot;</span>,</span><br><span class="line">        classLoader,</span><br><span class="line">        <span class="string">&quot;setOnDoubleClickListener&quot;</span>,</span><br><span class="line">        <span class="string">&quot;com.tencent.mm.plugin.story.api.i\$a&quot;</span>,</span><br><span class="line">        <span class="keyword">object</span> : XC_MethodReplacement() &#123;</span><br><span class="line">            <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">replaceHookedMethod</span><span class="params">(param: <span class="type">MethodHookParam</span>?)</span></span>: Any &#123;</span><br><span class="line">                xlog(<span class="string">&quot;replace double click&quot;</span>)</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>接下来分析下为什么也可以直接传String类型的类的名称，我们跟进<code>findAndHookMethod</code>找用到<code>parameterTypesAndCallback</code>参数的方法，<br>会发现它最终又会调用<code>findMethodExact</code>如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> XC_MethodHook.Unhook <span class="title function_">findAndHookMethod</span><span class="params">(Class&lt;?&gt; clazz, String methodName, Object... parameterTypesAndCallback)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (parameterTypesAndCallback.length == <span class="number">0</span> || !(parameterTypesAndCallback[parameterTypesAndCallback.length-<span class="number">1</span>] <span class="keyword">instanceof</span> XC_MethodHook))</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;no callback defined&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">XC_MethodHook</span> <span class="variable">callback</span> <span class="operator">=</span> (XC_MethodHook) parameterTypesAndCallback[parameterTypesAndCallback.length-<span class="number">1</span>];</span><br><span class="line">    <span class="type">Method</span> <span class="variable">m</span> <span class="operator">=</span> findMethodExact(clazz, methodName, getParameterClasses(clazz.getClassLoader(), parameterTypesAndCallback));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> XposedBridge.hookMethod(m, callback);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>继续看<code>getParameterClasses</code>方法如下，可以看到首先判断了如果type如果为空抛异常，如果为<code>XC_MethodHook</code>则不往下执行，<br>如果为<code>Class</code>则强转为Class，如果为<code>String</code>则调用<code>findClass((String) type, classLoader)</code>找到Class，方法最后返回Class，<br>所以<code>parameterTypesAndCallback</code>也可以直接传包名+类名：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> Class&lt;?&gt;[] getParameterClasses(ClassLoader classLoader, Object[] parameterTypesAndCallback) &#123;</span><br><span class="line">    Class&lt;?&gt;[] parameterClasses = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> parameterTypesAndCallback.length - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">        <span class="type">Object</span> <span class="variable">type</span> <span class="operator">=</span> parameterTypesAndCallback[i];</span><br><span class="line">        <span class="keyword">if</span> (type == <span class="literal">null</span>)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">ClassNotFoundError</span>(<span class="string">&quot;parameter type must not be null&quot;</span>, <span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ignore trailing callback</span></span><br><span class="line">        <span class="keyword">if</span> (type <span class="keyword">instanceof</span> XC_MethodHook)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (parameterClasses == <span class="literal">null</span>)</span><br><span class="line">            parameterClasses = <span class="keyword">new</span> <span class="title class_">Class</span>&lt;?&gt;[i+<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (type <span class="keyword">instanceof</span> Class)</span><br><span class="line">            parameterClasses[i] = (Class&lt;?&gt;) type;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (type <span class="keyword">instanceof</span> String)</span><br><span class="line">            parameterClasses[i] = findClass((String) type, classLoader);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">ClassNotFoundError</span>(<span class="string">&quot;parameter type must either be specified as Class or String&quot;</span>, <span class="literal">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// if there are no arguments for the method</span></span><br><span class="line">    <span class="keyword">if</span> (parameterClasses == <span class="literal">null</span>)</span><br><span class="line">        parameterClasses = <span class="keyword">new</span> <span class="title class_">Class</span>&lt;?&gt;[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> parameterClasses;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
  
	</div>
		<footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/Android%E9%80%86%E5%90%91/">Android逆向</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Android/">Android</a><a href="/tags/Xposed/">Xposed</a><a href="/tags/逆向/">逆向</a>
  </div>

</div>



	<div class="article-share" id="share">
	
	<div class="share-jiathis">
	  
<div class="jiathis_style_24x24">
	<a class="jiathis_button_tsina"></a>
	<a class="jiathis_button_weixin"></a>
	<a class="jiathis_button_renren"></a>
	<a class="jiathis_button_qzone"></a>
	<a class="jiathis_button_googleplus"></a>
	<a class="jiathis_button_douban"></a>
	<a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jtico jtico_jiathis" target="_blank"></a>
	<a class="jiathis_counter_style"></a>
</div>
<script type="text/javascript" >
    var jiathis_config={
    data_track_clickback:true,
    sm:"copy,renren,cqq",
    pic:"",
    summary:"",
    
  </script> 
<script type="text/javascript" src="//v3.jiathis.com/code/jia.js?uid=
2049638" charset="utf-8"></script>      

	 </div>
	
	</div>


</footer>

   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev" >
 <a href="/2022/06/22/Android-TV按键焦点原理浅谈/" title="Android TV按键焦点原理浅谈">
  <strong>上一篇：</strong><br/>
  <span>
  Android TV按键焦点原理浅谈</span>
</a>
</div>


<div class="next">
<a href="/2020/07/11/Xposed系列之微信装X指南(二)/"  title="Xposed系列之微信装X指南(二)">
 <strong>下一篇：</strong><br/> 
 <span>Xposed系列之微信装X指南(二)
</span>
</a>
</div>

</nav>

	
<section id="comments" class="comment">
	<div class="ds-thread" data-thread-key="2020/07/15/Xposed系列之微信屏蔽拍一拍(三)/" data-title="Xposed系列之微信屏蔽拍一拍(三)" data-url="http://yoursite.com/2020/07/15/Xposed%E7%B3%BB%E5%88%97%E4%B9%8B%E5%BE%AE%E4%BF%A1%E5%B1%8F%E8%94%BD%E6%8B%8D%E4%B8%80%E6%8B%8D(%E4%B8%89)/"></div>
</section>


</div>  
      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">文章目录</strong>
 
 <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9C%80%E6%B1%82"><span class="toc-number">1.</span> <span class="toc-text">需求</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%93%E6%9E%9C"><span class="toc-number">2.</span> <span class="toc-text">结果</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%86%E6%9E%90UI"><span class="toc-number">3.</span> <span class="toc-text">分析UI</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%86%E6%9E%90%E4%BB%A3%E7%A0%81"><span class="toc-number">4.</span> <span class="toc-text">分析代码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BC%96%E5%86%99%E4%BB%A3%E7%A0%81"><span class="toc-number">5.</span> <span class="toc-text">编写代码</span></a></li></ol>
 
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">

  
<div class="categorieslist">
	<p class="asidetitle">分类</p>
		<ul>
		
		  
			<li><a href="/categories/AI/" title="AI">AI<sup>6</sup></a></li>
		  
		
		  
			<li><a href="/categories/Android上传下载/" title="Android上传下载">Android上传下载<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Android图片/" title="Android图片">Android图片<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Android应用常用功能/" title="Android应用常用功能">Android应用常用功能<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Android性能/" title="Android性能">Android性能<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Android控件/" title="Android控件">Android控件<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/Android数据格式/" title="Android数据格式">Android数据格式<sup>6</sup></a></li>
		  
		
		  
			<li><a href="/categories/Android源码/" title="Android源码">Android源码<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Android第三方SDK及框架/" title="Android第三方SDK及框架">Android第三方SDK及框架<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/categories/Android线程/" title="Android线程">Android线程<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/Android网络编程/" title="Android网络编程">Android网络编程<sup>10</sup></a></li>
		  
		
		  
			<li><a href="/categories/Android逆向/" title="Android逆向">Android逆向<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/categories/Harmony/" title="Harmony">Harmony<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Java/" title="Java">Java<sup>4</sup></a></li>
		  
		
		  
			<li><a href="/categories/PS/" title="PS">PS<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/categories/Web/" title="Web">Web<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/算法/" title="算法">算法<sup>5</sup></a></li>
		  
		
		  
			<li><a href="/categories/自动化/" title="自动化">自动化<sup>2</sup></a></li>
		  
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">标签</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/Android/" title="Android">Android<sup>33</sup></a></li>
			
		
			
				<li><a href="/tags/网络编程/" title="网络编程">网络编程<sup>11</sup></a></li>
			
		
			
				<li><a href="/tags/UI设计/" title="UI设计">UI设计<sup>9</sup></a></li>
			
		
			
				<li><a href="/tags/数据格式/" title="数据格式">数据格式<sup>8</sup></a></li>
			
		
			
				<li><a href="/tags/AI/" title="AI">AI<sup>6</sup></a></li>
			
		
			
				<li><a href="/tags/控件/" title="控件">控件<sup>5</sup></a></li>
			
		
			
				<li><a href="/tags/算法/" title="算法">算法<sup>5</sup></a></li>
			
		
			
				<li><a href="/tags/Xposed/" title="Xposed">Xposed<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/逆向/" title="逆向">逆向<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/PS/" title="PS">PS<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/推送/" title="推送">推送<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/线程/" title="线程">线程<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/HTTP/" title="HTTP">HTTP<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/Socket/" title="Socket">Socket<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/抓包/" title="抓包">抓包<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/WCF/" title="WCF">WCF<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/原理/" title="原理">原理<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/性能/" title="性能">性能<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/自动化/" title="自动化">自动化<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Harmony/" title="Harmony">Harmony<sup>1</sup></a></li>
			
		
		</ul>
</div>


  <div class="linkslist">
  <p class="asidetitle">友情链接</p>
    <ul>
        
          <li>
            
            	<a href="http://zjbztianya.github.io/" target="_blank" title="仗剑奔走天涯">仗剑奔走天涯</a>
            
          </li>
        
          <li>
            
            	<a href="http://xbdcc.cn" target="_blank" title="小不点">小不点</a>
            
          </li>
        
          <li>
            
            	<a href="http://mkblog.cn/" target="_blank" title="孟坤博客">孟坤博客</a>
            
          </li>
        
    </ul>
</div>

  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS 订阅</a>
</div>

</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> Hello ,I&#39;m Carlos. <br/>
			This is my blog,believe it or not.</p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		<a href="http://weibo.com/xiaobudian1994" target="_blank" class="icon-weibo" title="微博"></a>
		
		
		
		
		
		
		
		<a href="https://www.douban.com/people/xbdcc" target="_blank" class="icon-douban" title="豆瓣"></a>
		
		
		
		
		<a href="mailto:363465939@qq.com" target="_blank" class="icon-email" title="Email Me"></a>
		
	</div>
			
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Jacman">Jacman</a> © 2024 
		
		<a href="/me" target="_blank" title="Carlos">Carlos</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  c.click(function(){
    ta.css('display', 'block').addClass('fadeIn');
  });
  o.click(function(){
    ta.css('display', 'none');
  });
  $(window).scroll(function(){
    ta.css("top",Math.max(140,320-$(this).scrollTop()));
  });
});
</script>




<script type="text/javascript">
  var duoshuoQuery = {short_name:"xbdcc"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
    || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
</script> 







<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->





<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="返回顶部"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->


  </body>
</html>
